---
layout: page
title: Ocular Diagnosis and Interpretability Teaching Module
description: Lab created for Applied Machine Learning EEC174AY on Ocular Diagnosis and Model Interpretability
img: assets/img/4_project/oct_example.png
importance: 2
category: teaching
related_publications: false
date: 2024-11-27
---

This page highlights **Mini-Project B1**, a teaching module I created for college-level machine learning students. This lab focuses on classifying ocular diseases using OCT scans, addressing data imbalance, and interpreting models through saliency mapping and clustering. **All solutions and outputs shown here are generated by me as the class is actively using this lab.**

---

## **Overview of Mini-Project**

This project demonstrates the following skills:

- **Medical Imaging Analysis:** Preprocessing and augmenting OCT scans.
- **Deep Learning for Classification:** Training models to classify ocular conditions.
- **Model Evaluation:** Utilizing metrics like ROC and AUC.
- **Model Interpretability:** Implementing saliency mapping with Grad-CAM.
- **Handling Data Imbalance:** Adjusting for imbalanced datasets with weighted sampling.
- **Unsupervised Learning:** Performing KMeans clustering for exploratory analysis.

Explore the assignment notebook here:  
[Mini-Project B1: OCT Scan Analysis and Interpretability](https://github.com/EEC174-Fall24/MiniProjectB1/blob/main/MiniProject_B1.ipynb)

---

## **Mini-Project B1: Ocular Diagnosis Using OCT Scans**

### **Objective**

To classify ocular diseases using deep learning models trained on OCT scans and gain insights into model performance through interpretability and unsupervised learning techniques.

### **Dataset Information**

- **Classes:** 4 Ocular Conditions:
  1. Healthy
  2. CNV (Choroidal Neovascularization): Growth of abnormal blood vessels under the retina.
  3. DME (Diabetic Macular Edema): Retinal swelling due to diabetes.
  4. DRUSEN: Deposits under the retina, often related to age-related degeneration.
- **Dataset Tasks:**
  - Loading images from the OCT dataset.
  - Performing augmentations and visualizing images for each class.
  - Creating balanced and unbalanced datasets for training and analysis.

### **Skills and Learning Outcomes**

- Training a deep learning model for medical image classification.
- Visualizing performance with ROC and AUC curves.
- Using Grad-CAM for model interpretability.
- Addressing data imbalance through sampling adjustments.
- Implementing KMeans clustering for unsupervised learning.

### **Sample Outputs**

> _Note: The outputs below are sample results generated by me while creating the lab and solutions. Solutions and full implementations are withheld to maintain academic integrity._

1. **Image Visualization by Class:**
   {% include figure.liquid loading="eager" path="assets/img/4_project/classes.png" title="OCT Scan Class Visualization" class="img-fluid rounded z-depth-1" %}

2. **ROC and AUC Curve Visualization:**

   <div class="row justify-content-sm-center">
    <div class="col-sm-4 mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/4_project/roc_auc.png" title="ROC and AUC Curve" class="img-fluid rounded z-depth-1" %}
    </div>
</div>

3. **Grad-CAM Saliency Mapping:**
   {% include figure.liquid loading="eager" path="assets/img/4_project/grad_cam_sample.png" title="Grad-CAM Saliency Mapping" class="img-fluid rounded z-depth-1" %}

4. **KMeans Clustering on OCT Data:**
   {% include figure.liquid loading="eager" path="assets/img/4_project/kmeans_clustering.png" title="KMeans Clustering Results" class="img-fluid rounded z-depth-1" %}
5. **Example KMeans Clustering on MNIST Dataset:**
   {% include figure.liquid loading="eager" path="assets/img/4_project/mnist_clustering.png" title="KMeans Clustering Results" class="img-fluid rounded z-depth-1" %}

---

## **Detailed Steps in the Lab:**

### **1. Dataset Setup and Training:**

- Load images from the OCT dataset.
- Perform data augmentations to improve model generalization.
- Create dataset loaders and visualize class distributions.
- Train a chosen deep learning model on the OCT dataset.

### **2. Model Evaluation:**

- Evaluate model performance using metrics such as:
  - Loss and accuracy.
  - ROC and AUC curves for binary and multi-class classification.

### **3. Model Interpretability:**

- Implement saliency mapping using the Grad-CAM library:
  - Highlight regions of OCT scans contributing most to the model's predictions.
  - Generate visual explanations of model decisions.

### **4. Handling Data Imbalance:**

- Train the model on an unbalanced version of the dataset.
- Use weighted sampling to adjust for imbalanced class distributions.
- Compare model performance before and after balancing.

### **5. Unsupervised Learning:**

- Apply KMeans clustering to OCT scan features:
  - Visualize cluster assignments for exploratory data analysis.

---

## **Key Takeaways**

This project illustrates:

- The application of deep learning and interpretability techniques to medical imaging tasks.
- Techniques for addressing data imbalance in real-world datasets.
- Hands-on experience with both supervised and unsupervised learning approaches.
- Preparation for tackling real-world challenges in medical AI research.

---

Explore the assignment notebook here:  
[Mini-Project B1: OCT Scan Analysis and Interpretability](https://github.com/EEC174-Fall24/MiniProjectB1/blob/main/MiniProject_B1.ipynb)

---

The cover GIF for the project is reproduced from [Nature Scientific Reports](https://www.nature.com/articles/s41598-023-41362-4/figures/3), under the Creative Commons Attribution 4.0 International License. Full credit to the original authors.
